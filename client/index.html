<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>blog</title>
</head>

<body>
    <div id="app">
        <input type="text" id="name">
        <input type="text" id="pwd">
    </div>
    <a href="javascript:;" class="login">登录</a>
    <a href="javascript:;" class="reg">注册</a>
</body>
<script>
document.querySelector('.login').onclick = function() {
    let name = document.querySelector('#name').value
    let password = document.querySelector('#pwd').value
    _ajax({
        url: '/signin',
        type: 'POST',
        data: {
            name: name,
            password: password
        },
        success: function(res) {}
    });
}

document.querySelector('.reg').onclick = function() {
    let name = document.querySelector('#name').value
    let password = document.querySelector('#pwd').value
    _ajax({
        url: '/register',
        type: 'POST',
        data: {
            name: name,
            password: password
        },
        success: function(res) {}
    });
}

_ajax = function(obj) {
    obj = obj || {};
    obj.type = (obj.type || 'GET').toUpperCase();
    obj.dataType = obj.dataType || 'json';

    var params = _formatParams(obj.data);
    var xhr;

    if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
    } else {
        xhr = new AxtiveXObject('Microsoft.XMLHTTP');
    }
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
            if (xhr.status >= 200 && xhr.status < 300) {
                obj.success && obj.success(xhr.responseText, xhr.responseXML);
            } else {
                obj.error && obj.error(xhr.status);
            }
        }
    }

    if (obj.type === 'GET') {
        xhr.open('GET', obj.url + '?' + params, true);
        xhr.send(null);
    } else if (obj.type === 'POST') {
        xhr.open('POST', obj.url, true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.send(params);
    }
};

// 格式化参数
_formatParams = function(data) {
    var arr = [];
    for (var name in data) {
        arr.push(encodeURIComponent(name) + '=' + encodeURIComponent(data[name]));
    }
    // 清除缓存
    arr.push('t=' + Math.random());
    return arr.join('&');
};
</script>

</html>